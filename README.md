# è½¯ä»¶è´¨é‡
## 1. ä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰
ä½œç”¨ï¼š
ä»£ç å®¡æŸ¥æ˜¯æŒ‡åœ¨ä»£ç æäº¤ä¹‹å‰ï¼Œé€šè¿‡å¼€å‘å›¢é˜Ÿçš„å…¶ä»–æˆå‘˜å¯¹ä»£ç è¿›è¡Œæ£€æŸ¥å’Œè®¨è®ºï¼Œä»¥å‘ç°æ½œåœ¨çš„ç¼ºé™·ã€æå‡ä»£ç è´¨é‡å’Œç»´æŠ¤å¯è¯»æ€§ã€‚ä»£ç å®¡æŸ¥æœ‰åŠ©äºï¼š
* æé«˜ä»£ç è´¨é‡ï¼Œç¡®ä¿éµå¾ªç¼–ç¨‹è§„èŒƒã€‚
* ä¿ƒè¿›çŸ¥è¯†å…±äº«ï¼Œå‡å°‘å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„çŸ¥è¯†å·®è·ã€‚
* æ—©æœŸå‘ç°é”™è¯¯ï¼Œé™ä½åç»­ç»´æŠ¤æˆæœ¬ã€‚
* ä¸ºæ–°æˆå‘˜æä¾›å­¦ä¹ æœºä¼šï¼ŒåŠ å¿«ä¸Šæ‰‹é€Ÿåº¦ã€‚

å¦‚ä½•åšï¼š
* é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼šä½¿ç”¨åƒGitHubã€GitLabã€Bitbucketç­‰å·¥å…·è‡ªå¸¦çš„ä»£ç å®¡æŸ¥åŠŸèƒ½ã€‚
* è®¾å®šæ˜ç¡®çš„å®¡æŸ¥æ ‡å‡†ï¼šæ˜ç¡®å›¢é˜Ÿåœ¨ä»£ç é£æ ¼ã€ç»“æ„ã€æ€§èƒ½å’Œå®‰å…¨æ–¹é¢çš„æ ‡å‡†ã€‚
* è¿›è¡Œé€è¡Œå®¡æŸ¥ï¼šå®¡æŸ¥äººå‘˜é€è¡Œæ£€æŸ¥ä»£ç ï¼Œæå‡ºæ„è§å’Œå»ºè®®ã€‚
* æä¾›å»ºè®¾æ€§åé¦ˆï¼šåº”æ³¨é‡æå‡ºè§£å†³æ–¹æ¡ˆè€Œä¸æ˜¯ä»…æŒ‡å‡ºé—®é¢˜ï¼Œä»¥ä¿ƒè¿›æ”¹è¿›ã€‚
* ç¡®ä¿è·Ÿè¿›ï¼šåœ¨å®¡æŸ¥å®Œæˆåï¼Œç¡®ä¿å¼€å‘äººå‘˜æ ¹æ®åé¦ˆè¿›è¡Œä¿®æ”¹ï¼Œå¹¶é‡æ–°æäº¤ã€‚

## 2. å•å…ƒæµ‹è¯•ï¼ˆUnit Testingï¼‰
ä½œç”¨ï¼š
å•å…ƒæµ‹è¯•æ˜¯å¯¹æœ€å°å¯æµ‹è¯•å•å…ƒï¼ˆé€šå¸¸æ˜¯å‡½æ•°æˆ–ç±»ï¼‰è¿›è¡ŒéªŒè¯çš„è¿‡ç¨‹ï¼Œç›®çš„åœ¨äºç¡®ä¿æ¯ä¸ªå•å…ƒéƒ½èƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚å…¶ä½œç”¨åŒ…æ‹¬ï¼š
* æé«˜ä»£ç å¯é æ€§ï¼Œç¡®ä¿æ–°ä»£ç æœªç ´åç°æœ‰åŠŸèƒ½ã€‚
* æ”¯æŒé‡æ„ï¼Œä¾¿äºåœ¨ä¸ç ´ååŠŸèƒ½çš„æƒ…å†µä¸‹æ”¹è¿›ä»£ç ã€‚
* æä¾›æ–‡æ¡£ï¼Œå•å…ƒæµ‹è¯•å¯ä»¥ä½œä¸ºä½¿ç”¨ä»£ç çš„ç¤ºä¾‹ã€‚
* ç¼©çŸ­è°ƒè¯•æ—¶é—´ï¼ŒåŠæ—©å‘ç°å’Œä¿®å¤é”™è¯¯ã€‚

å¦‚ä½•åšï¼š
* é€‰æ‹©æµ‹è¯•æ¡†æ¶ï¼šå¸¸ç”¨çš„æµ‹è¯•æ¡†æ¶åŒ…æ‹¬JUnitï¼ˆJavaï¼‰ã€pytestï¼ˆPythonï¼‰ã€Mochaï¼ˆNode.jsï¼‰ç­‰ã€‚
* ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼šä¸ºæ¯ä¸ªå•å…ƒå®šä¹‰æ¸…æ™°çš„è¾“å…¥è¾“å‡ºï¼Œå†™å‡ºç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹ã€‚
* ä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡ï¼šå¯¹äºä¾èµ–å¤–éƒ¨ç³»ç»Ÿçš„å•å…ƒï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡ï¼ˆMockï¼‰æ¥æ›¿ä»£ï¼Œè®©æµ‹è¯•ä¸“æ³¨äºå•å…ƒæœ¬èº«ã€‚
* æŒç»­é›†æˆï¼šåœ¨æŒç»­é›†æˆï¼ˆCIï¼‰è¿‡ç¨‹ä¸­è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•ï¼Œç¡®ä¿æ¯æ¬¡æäº¤éƒ½ç»è¿‡éªŒè¯ã€‚

## 3. æ—¥å¿—ï¼ˆLoggingï¼‰
ä½œç”¨ï¼šæ—¥å¿—æ˜¯ä¸€ç§è®°å½•ç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯çš„æœºåˆ¶ï¼Œå¯¹äºæ•…éšœæ’æŸ¥ã€ç³»ç»Ÿç›‘æ§å’Œæ€§èƒ½åˆ†æè‡³å…³é‡è¦ã€‚å…¶ä½œç”¨åŒ…æ‹¬ï¼š
* ç›‘æ§åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸çŠ¶æ€ã€‚
* æä¾›æ•…éšœæ’æŸ¥ä¾æ®ï¼Œä¾¿äºåˆ†æé—®é¢˜æ ¹æºã€‚
* ä¸ºç”¨æˆ·è¡Œä¸ºåˆ†ææä¾›æ•°æ®æ”¯æŒï¼Œä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ã€‚
* è®°å½•é‡è¦äº‹ä»¶ï¼Œä¾¿äºåç»­å®¡è®¡å’Œåˆè§„ã€‚

å¦‚ä½•åšï¼š
* é€‰æ‹©åˆé€‚çš„æ—¥å¿—åº“ï¼šä¾‹å¦‚ï¼ŒPythonä¸­çš„loggingæ¨¡å—ã€Javaä¸­çš„Log4jç­‰ã€‚
* å®šä¹‰æ—¥å¿—çº§åˆ«ï¼šé€šå¸¸åŒ…æ‹¬DEBUGã€INFOã€WARNINGã€ERRORå’ŒCRITICALï¼Œä¾æ®ä¸åŒæƒ…å†µè®°å½•ä¸åŒçº§åˆ«çš„ä¿¡æ¯ã€‚
* è§„èŒƒæ—¥å¿—æ ¼å¼ï¼šç¡®ä¿æ—¥å¿—ä¿¡æ¯æ¸…æ™°ï¼ŒåŒ…å«æ—¶é—´æˆ³ã€æ—¥å¿—çº§åˆ«ã€æ¨¡å—åã€æ¶ˆæ¯ç­‰å…³é”®ä¿¡æ¯ã€‚
* å®šæœŸç›‘æ§å’Œåˆ†ææ—¥å¿—ï¼šä½¿ç”¨å·¥å…·ï¼ˆå¦‚ELK Stackï¼‰é›†ä¸­å­˜å‚¨å’Œåˆ†ææ—¥å¿—ï¼Œä¾¿äºå®æ—¶ç›‘æ§å’Œå†æ—¶æ•°æ®åˆ†æã€‚

## 4. æ–­ç‚¹è·Ÿè¸ªï¼ˆBreakpoint Debuggingï¼‰
ä½œç”¨ï¼šæ–­ç‚¹è·Ÿè¸ªæ˜¯è°ƒè¯•ä»£ç æ—¶çš„ä¸€ç§æŠ€æœ¯ï¼Œé€šè¿‡è®¾ç½®æ–­ç‚¹æ¥æš‚åœç¨‹åºæ‰§è¡Œï¼Œæ£€æŸ¥ç¨‹åºçŠ¶æ€ã€‚å…¶ç›®çš„åœ¨äºï¼š

* é€æ­¥åˆ†æä»£ç æ‰§è¡Œæµç¨‹ï¼Œæ‰¾å‡ºé€»è¾‘é”™è¯¯ã€‚
* æŸ¥çœ‹å˜é‡çš„å€¼å’ŒçŠ¶æ€ï¼Œç†è§£ç¨‹åºåœ¨è¿è¡Œæ—¶çš„è¡¨ç°ã€‚
* é‡ç°å¹¶è°ƒè¯•å¤æ‚é—®é¢˜ï¼Œå°¤å…¶æ˜¯éš¾ä»¥é€šè¿‡å…¶ä»–æ‰‹æ®µå‘ç°çš„é—®é¢˜ã€‚

å¦‚ä½•åšï¼š
* ä½¿ç”¨ IDE æä¾›çš„è°ƒè¯•å·¥å…·ï¼šå¦‚Visual Studioã€Eclipseã€PyCharmç­‰ï¼Œåˆ©ç”¨å…¶å†…ç½®çš„è°ƒè¯•å™¨è®¾ç½®æ–­ç‚¹ã€‚
* é€æ­¥æ‰§è¡Œï¼šåœ¨æ–­ç‚¹å¤„æš‚åœç¨‹åºï¼Œé€æ­¥æ‰§è¡Œæ¯ä¸€è¡Œä»£ç ï¼Œè§‚å¯Ÿå˜é‡å˜åŒ–å’Œç¨‹åºé€»è¾‘ã€‚
* è§‚å¯Ÿè¡¨è¾¾å¼ï¼šç›‘æ§ç‰¹å®šå˜é‡æˆ–è¡¨è¾¾å¼çš„å€¼ï¼Œäº†è§£å…¶åœ¨ä¸åŒæ‰§è¡Œé˜¶æ®µçš„çŠ¶æ€ã€‚
* å †æ ˆè·Ÿè¸ªï¼šåœ¨ç¨‹åºå´©æºƒæ—¶ï¼ŒæŸ¥çœ‹å †æ ˆä¿¡æ¯ï¼Œåˆ†æè°ƒç”¨è·¯å¾„ä»¥æ‰¾åˆ°å‡ºé”™çš„åœ°æ–¹ã€‚

# pythonä»£ç æ£€æµ‹å’Œgité¢„å¤„ç†

## 1. åˆ›å»ºMakefileæ–‡ä»¶

```bash
# Define the Python interpreter
PYTHON := xx/bin/python3

# Define the tools for static code analysis
PYLINT := pylint
FLAKE8 := flake8
MYPY := mypy

# å°†ä½ çš„ Python ä»£ç æ”¾åœ¨ src å’Œ tests ç›®å½•ä¸‹ï¼Œæˆ–è€…æ ¹æ®éœ€è¦ä¿®æ”¹ SRC å’Œ TESTS å˜é‡ã€‚
#SRC := src
TESTS := xx/*
ALL := $(TESTS)

.PHONY: help lint flake8 pylint mypy check_syntax lint_file pylint_file flake8_file mypy_file check_syntax_file

help:
	@echo "Available targets:"
	@echo "  lint                - Run all static code checks (pylint, flake8, mypy)"
	@echo "  pylint              - Run pylint checks"
	@echo "  flake8              - Run flake8 checks"
	@echo "  mypy                - Run mypy checks"
	@echo "  check_syntax        - Check Python syntax (compilation)"
	@echo "  lint_file file=FILE - Run all static code checks on a specific file"
	@echo "  pylint_file file=FILE - Run pylint checks on a specific file"
	@echo "  flake8_file file=FILE - Run flake8 checks on a specific file"
	@echo "  mypy_file file=FILE - Run mypy checks on a specific file"
	@echo "  check_syntax_file file=FILE - Check Python syntax (compilation) on a specific file"

lint: pylint flake8 mypy

pylint:
	@echo "Running pylint..."
	$(PYTHON) -m $(PYLINT) $(ALL)

flake8:
	@echo "Running flake8..."
	$(PYTHON) -m $(FLAKE8) $(ALL)

mypy:
	@echo "Running mypy..."
	$(PYTHON) -m $(MYPY) $(ALL)

check_syntax:
	@echo "Checking Python syntax..."
	@$(PYTHON) -m compileall $(ALL)

lint_file: pylint_file flake8_file mypy_file

pylint_file:
	@echo "Running pylint on $(file)..."
	$(PYTHON) -m $(PYLINT) $(file)

flake8_file:
	@echo "Running flake8 on $(file)..."
	$(PYTHON) -m $(FLAKE8) $(file)

mypy_file:
	@echo "Running mypy on $(file)..."
	$(PYTHON) -m $(MYPY) $(file)

check_syntax_file:
	@echo "Checking Python syntax on $(file)..."
	@$(PYTHON) -m compileall $(file)
```

## 2. é…ç½®å…·ä½“è§„åˆ™é…ç½®æ–‡ä»¶

### 2.1 åˆ›å»ºpyproject.tomlï¼ˆmypyé…ç½®ï¼‰

```bash
# https://mypy.readthedocs.io/en/stable/config_file.html
# é‡è¦çš„æ˜¯è¦ç†è§£ï¼Œé…ç½®æ–‡ä»¶æ²¡æœ‰åˆå¹¶ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ­§ä¹‰ã€‚ --config-file å‘½ä»¤è¡Œæ ‡å¿—å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”å¿…é¡»æ­£ç¡®;å¦åˆ™mypyå°†æŠ¥å‘Šé”™è¯¯å¹¶é€€å‡ºã€‚å¦‚æœæ²¡æœ‰å‘½ä»¤è¡Œé€‰é¡¹ï¼Œmypyå°†æŒ‰ç…§ä¸Šé¢çš„ä¼˜å…ˆçº§é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ã€‚
[tool.mypy]
# æ’é™¤ç‰¹å®šçš„æ–‡ä»¶æˆ–ç›®å½•
exclude = [
    '^test*\.py$',  # TOML literal string (single-quotes, no escaping necessary)
    "^test*\\.py$",  # TOML basic string (double-quotes, backslash and other characters need escaping)
]


# å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œå®ƒå°†å¯ç”¨ä¸€ç»„å¯¹ç±»å‹æ£€æŸ¥æ›´ä¸¥æ ¼çš„é€‰é¡¹
strict = true

# æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
show_error_context = true

# å…è®¸æ¨æ–­ä¸º Any çš„å˜é‡
allow_untyped_calls = false

# å¦‚æœæ²¡æœ‰æä¾›ç±»å‹æ³¨é‡Šï¼Œå…è®¸æ¨æ–­ä¸º Any
allow_untyped_globals = false

# æ£€æŸ¥æœªä½¿ç”¨çš„å¿½ç•¥æŒ‡ç¤ºç¬¦ï¼ˆ# type: ignoreï¼‰
warn_unused_ignores = true

# æ£€æŸ¥æœªä½¿ç”¨çš„å¯¼å…¥
warn_unused_configs = true

# è­¦å‘Šæ²¡æœ‰ç±»å‹æç¤ºçš„å‡½æ•°
warn_no_return = true

# ä¸º None æ£€æŸ¥é”™è¯¯
no_implicit_optional = true

# å¿½ç•¥ç¼ºå°‘å¯¼å…¥çš„æ¨¡å—ï¼ˆä¾‹å¦‚ C æ‰©å±•æ¨¡å—ï¼‰
ignore_missing_imports = true

# å¿½ç•¥ç‰¹å®šçš„é”™è¯¯ç±»å‹
disable_error_code = ["misc", "no-untyped-def", "no-untyped-call"]

# å¯ç”¨å¯¹å­—èŠ‚ç æ–‡ä»¶çš„ç¼“å­˜ä»¥æé«˜æ€§èƒ½
cache_dir = ".mypy_cache"

# æŒ‡å®šè¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–ç›®å½•
files = ["src"]

# æ‰“å¼€æˆ–å…³é—­ç‰¹å®šçš„ç±»å‹æ£€æŸ¥è§„åˆ™
check_untyped_defs = true
disallow_any_unimported = true
disallow_any_expr = true
disallow_any_generics = true
disallow_any_decorated = true

# ç¦æ­¢æœªæ³¨é‡Šçš„å‡½æ•°å®šä¹‰
disallow_untyped_defs = true

# ç¦æ­¢æœªæ³¨é‡Šçš„è°ƒç”¨
disallow_untyped_calls = true

# ç¦æ­¢æ— ç±»å‹æ³¨é‡Šçš„å…¨å±€å˜é‡
disallow_untyped_globals = true

# ç¦æ­¢ä½¿ç”¨åŠ¨æ€ç±»å‹ï¼ˆAnyï¼‰
disallow_any_explicit = true

# ç¦æ­¢å°† None éšå¼åœ°åˆ†é…ç»™å¯é€‰ç±»å‹
disallow_subclassing_any = true

# å¯ç”¨å¯¹æ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
strict_optional = false

# å¯ç”¨å¯¹å­—é¢é‡ç±»å‹çš„æ”¯æŒ
allow_redefinition = false

# è­¦å‘Šå¯¹åŠ¨æ€ç±»å‹çš„ä½¿ç”¨
warn_redundant_casts = true
warn_return_any = true
warn_unreachable = true

# å…è®¸å’Œå¿½ç•¥çš„ç±»å‹åˆ«å
implicit_reexport = true

# æŒ‡å®š Python ç‰ˆæœ¬
python_version = "3.9"

# å¯ç”¨å¯¹æ’ä»¶çš„æ”¯æŒ
plugins = []

# é’ˆå¯¹ç‰¹å®šæ¨¡å—çš„é…ç½®
[[tool.mypy.overrides]]
module = "*.tests.*"
ignore_errors = true

[[tool.mypy.overrides]]
module = "somelibrary"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "path.to.ignore"
ignore_errors = true

[[tool.mypy.overrides]]
module = "django.*"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "numpy.*"
ignore_missing_imports = true
```

### 2.2 åˆ›å»º.pylintrcï¼ˆpylinté…ç½®ï¼‰

```bash
# https://mypy.readthedocs.io/en/stable/config_file.html
# é‡è¦çš„æ˜¯è¦ç†è§£ï¼Œé…ç½®æ–‡ä»¶æ²¡æœ‰åˆå¹¶ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ­§ä¹‰ã€‚ --config-file å‘½ä»¤è¡Œæ ‡å¿—å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”å¿…é¡»æ­£ç¡®;å¦åˆ™mypyå°†æŠ¥å‘Šé”™è¯¯å¹¶é€€å‡ºã€‚å¦‚æœæ²¡æœ‰å‘½ä»¤è¡Œé€‰é¡¹ï¼Œmypyå°†æŒ‰ç…§ä¸Šé¢çš„ä¼˜å…ˆçº§é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ã€‚
[tool.mypy]
# æ’é™¤ç‰¹å®šçš„æ–‡ä»¶æˆ–ç›®å½•
exclude = [
    '^test*\.py$',  # TOML literal string (single-quotes, no escaping necessary)
    "^test*\\.py$",  # TOML basic string (double-quotes, backslash and other characters need escaping)
]


# å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œå®ƒå°†å¯ç”¨ä¸€ç»„å¯¹ç±»å‹æ£€æŸ¥æ›´ä¸¥æ ¼çš„é€‰é¡¹
strict = true

# æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
show_error_context = true

# å…è®¸æ¨æ–­ä¸º Any çš„å˜é‡
allow_untyped_calls = false

# å¦‚æœæ²¡æœ‰æä¾›ç±»å‹æ³¨é‡Šï¼Œå…è®¸æ¨æ–­ä¸º Any
allow_untyped_globals = false

# æ£€æŸ¥æœªä½¿ç”¨çš„å¿½ç•¥æŒ‡ç¤ºç¬¦ï¼ˆ# type: ignoreï¼‰
warn_unused_ignores = true

# æ£€æŸ¥æœªä½¿ç”¨çš„å¯¼å…¥
warn_unused_configs = true

# è­¦å‘Šæ²¡æœ‰ç±»å‹æç¤ºçš„å‡½æ•°
warn_no_return = true

# ä¸º None æ£€æŸ¥é”™è¯¯
no_implicit_optional = true

# å¿½ç•¥ç¼ºå°‘å¯¼å…¥çš„æ¨¡å—ï¼ˆä¾‹å¦‚ C æ‰©å±•æ¨¡å—ï¼‰
ignore_missing_imports = true

# å¿½ç•¥ç‰¹å®šçš„é”™è¯¯ç±»å‹
disable_error_code = ["misc", "no-untyped-def", "no-untyped-call"]

# å¯ç”¨å¯¹å­—èŠ‚ç æ–‡ä»¶çš„ç¼“å­˜ä»¥æé«˜æ€§èƒ½
cache_dir = ".mypy_cache"

# æŒ‡å®šè¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–ç›®å½•
files = ["src"]

# æ‰“å¼€æˆ–å…³é—­ç‰¹å®šçš„ç±»å‹æ£€æŸ¥è§„åˆ™
check_untyped_defs = true
disallow_any_unimported = true
disallow_any_expr = true
disallow_any_generics = true
disallow_any_decorated = true

# ç¦æ­¢æœªæ³¨é‡Šçš„å‡½æ•°å®šä¹‰
disallow_untyped_defs = true

# ç¦æ­¢æœªæ³¨é‡Šçš„è°ƒç”¨
disallow_untyped_calls = true

# ç¦æ­¢æ— ç±»å‹æ³¨é‡Šçš„å…¨å±€å˜é‡
disallow_untyped_globals = true

# ç¦æ­¢ä½¿ç”¨åŠ¨æ€ç±»å‹ï¼ˆAnyï¼‰
disallow_any_explicit = true

# ç¦æ­¢å°† None éšå¼åœ°åˆ†é…ç»™å¯é€‰ç±»å‹
disallow_subclassing_any = true

# å¯ç”¨å¯¹æ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
strict_optional = false

# å¯ç”¨å¯¹å­—é¢é‡ç±»å‹çš„æ”¯æŒ
allow_redefinition = false

# è­¦å‘Šå¯¹åŠ¨æ€ç±»å‹çš„ä½¿ç”¨
warn_redundant_casts = true
warn_return_any = true
warn_unreachable = true

# å…è®¸å’Œå¿½ç•¥çš„ç±»å‹åˆ«å
implicit_reexport = true

# æŒ‡å®š Python ç‰ˆæœ¬
python_version = "3.9"

# å¯ç”¨å¯¹æ’ä»¶çš„æ”¯æŒ
plugins = []

# é’ˆå¯¹ç‰¹å®šæ¨¡å—çš„é…ç½®
[[tool.mypy.overrides]]
module = "*.tests.*"
ignore_errors = true

[[tool.mypy.overrides]]
module = "somelibrary"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "path.to.ignore"
ignore_errors = true

[[tool.mypy.overrides]]
module = "django.*"
ignore_missing_imports = true

[[tool.mypy.overrides]]
module = "numpy.*"
ignore_missing_imports = true

```

## 3. åˆ›å»ºgitçš„pre-commit
**Git hooks manager:**
https://github.com/evilmartians/lefthook
```bash
# ä½¿ç”¨ pre-commit å·¥å…·ï¼Œå®ƒå…è®¸ä½ ç®¡ç†å’Œé…ç½®å¤šä¸ªé¢„æäº¤é’©å­
1. pip install pre-commit
2. åˆ›å»º .pre-commit-config.yaml æ–‡ä»¶
```yaml
repos:
  - repo: local
    hooks:
      - id: run-local-script
        name: Run Local Script
        entry: bash your_script.sh
        language: system
        files: \.py$
        stages: [commit]
        always_run: true
files: \.py$ï¼šæŒ‡å®šåªæ£€æŸ¥ Python æ–‡ä»¶ã€‚
stages: [commit]ï¼šç¡®ä¿é’©å­åœ¨ commit é˜¶æ®µè¿è¡Œã€‚
always_run: trueï¼šç¡®ä¿é’©å­å§‹ç»ˆè¿è¡Œã€‚
```
```yaml
repos:
  - repo: local
    hooks:
      - id: check-all-py  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        name: Check Local .py Script
        entry: bash check_py_files.sh
        language: system  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        files: \.py$  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        stages: [commit]  # æŒ‡å®šé’©å­åœ¨å“ªäº›é˜¶æ®µè¿è¡Œã€‚åœ¨è¿™é‡Œï¼Œé’©å­å°†åœ¨æäº¤é˜¶æ®µè¿è¡Œã€‚
        always_run: true  # æŒ‡å®šé’©å­æ˜¯å¦åœ¨æ¯æ¬¡æäº¤æ—¶éƒ½è¿è¡Œï¼Œå³ä½¿æ²¡æœ‰ç›¸å…³æ–‡ä»¶æ›´æ”¹
      - id: check-added-large-files
        name: Check Added Large Files  # æ·»åŠ  name é”®
        entry: echo "Check Added Large Files"  # æ·»åŠ  entry é”®
        language: system
        args: ['--maxkb=10240']  # è®¾ç½®æœ€å¤§æ–‡ä»¶å¤§å°ä¸º10MB
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0 # æŒ‡å®šäº†ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œæ˜¯ v4.6.0ã€‚
    hooks:
      - id: end-of-file-fixer # ç¡®ä¿æ–‡ä»¶ä»¥æ¢è¡Œç¬¦ç»“æŸã€‚
      - id: trailing-whitespace # åˆ é™¤è¡Œå°¾çš„å¤šä½™ç©ºæ ¼ã€‚
  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 0.29.2
    hooks:
      - id: check-github-workflows
        args: ["--verbose"]
  - repo: https://github.com/codespell-project/codespell
    rev: v2.3.0
    hooks:
      - id: codespell # ç”¨äºæ£€æŸ¥æ‹¼å†™é”™è¯¯ï¼Œ--write-changes å‚æ•°è¡¨ç¤ºè‡ªåŠ¨ä¿®å¤æ‹¼å†™é”™è¯¯ã€‚
        args: ["--write-changes"]
  - repo: https://github.com/tox-dev/tox-ini-fmt
    rev: "1.4.1"
    hooks:
      - id: tox-ini-fmt # æ ¼å¼åŒ– tox.ini æ–‡ä»¶ï¼Œ-p fix å‚æ•°è¡¨ç¤ºè¿›è¡Œä¿®å¤ã€‚
        args: ["-p", "fix"]
  - repo: https://github.com/tox-dev/pyproject-fmt
    rev: "2.2.4"
    hooks:
      - id: pyproject-fmt # æ ¼å¼åŒ– pyproject.toml æ–‡ä»¶ã€‚
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: "v0.6.7"
    hooks:
      - id: ruff-format # ç”¨äºæ ¼å¼åŒ–ä»£ç ã€‚
      - id: ruff
        args: ["--fix", "--unsafe-fixes", "--exit-non-zero-on-fix"] # è¿›è¡Œä»£ç æ£€æŸ¥ï¼Œ--fix è¡¨ç¤ºè‡ªåŠ¨ä¿®å¤ï¼Œ--unsafe-fixes å…è®¸ä¸å®‰å…¨çš„ä¿®å¤ï¼Œ--exit-non-zero-on-fix è¡¨ç¤ºå¦‚æœè¿›è¡Œäº†ä¿®å¤åˆ™è¿”å›éé›¶çŠ¶æ€ã€‚
  - repo: meta
    hooks:
      - id: check-hooks-apply # æ£€æŸ¥æ‰€æœ‰é’©å­æ˜¯å¦éƒ½å·²åº”ç”¨ã€‚
      - id: check-useless-excludes # æ£€æŸ¥é…ç½®ä¸­æ˜¯å¦å­˜åœ¨æ— ç”¨çš„æ’é™¤é¡¹ã€‚
```
```yaml
repos:
  - repo: local
    hooks:
      - id: check-all-py  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        name: Check Local .py Script
        entry: bash check_py_files.sh
        language: system  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        files: \.py$  # æ¯ä¸ªé’©å­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œç”¨äºå¼•ç”¨è¯¥é’©å­ã€‚
        stages: [commit]  # æŒ‡å®šé’©å­åœ¨å“ªäº›é˜¶æ®µè¿è¡Œã€‚åœ¨è¿™é‡Œï¼Œé’©å­å°†åœ¨æäº¤é˜¶æ®µè¿è¡Œã€‚
        always_run: true  # æŒ‡å®šé’©å­æ˜¯å¦åœ¨æ¯æ¬¡æäº¤æ—¶éƒ½è¿è¡Œï¼Œå³ä½¿æ²¡æœ‰ç›¸å…³æ–‡ä»¶æ›´æ”¹
      - id: check-added-large-files
        name: Check Added Large Files  # æ·»åŠ  name é”®
        entry: echo "Check Added Large Files"  # æ·»åŠ  entry é”®
        language: system
        args: ['--maxkb=10240']  # è®¾ç½®æœ€å¤§æ–‡ä»¶å¤§å°ä¸º10MB
```
3. pre-commit install å®‰è£…é¢„æäº¤é’©å­
$ pre-commit install 
pre-commit installed at .git/hooks/pre-commit

## check_py_files.sh
```bash
#!/bin/bash

# Get the list of staged files for commit
FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.py$')

# Check if there are any Python files to process
if [ -z "$FILES" ]; then
  echo "No Python files to check."
  exit 0
fi

# Example script
echo "Running pre-commit script..."

# Loop through each file and run make pylint_file, flake8_file, and mypy_file
for FILE in $FILES; do
    echo "STEP0: Running make check file syntax=$FILE..."
    make check_syntax_file file="$FILE"
    if [ $? -ne 0 ]; then
        echo "Compileall failed for $FILE. Aborting commit."
        exit 1
    fi
    
    echo "STEP1: Running make pylint_file file=$FILE..."
    make pylint_file file="$FILE"
    if [ $? -ne 0 ]; then
        echo "Pylint failed for $FILE. Aborting commit."
        exit 1
    fi

    echo "STEP2: Running make flake8_file file=$FILE..."
    make flake8_file file="$FILE"
    if [ $? -ne 0 ]; then
        echo "Flake8 failed for $FILE. Aborting commit."
        exit 1
    fi

    echo "STEP2: Running make mypy_file file=$FILE..."
    make mypy_file file="$FILE"
    if [ $? -ne 0 ]; then
        echo "Mypy failed for $FILE. Aborting commit."
        exit 1
    fi
done

echo "Pre-commit script finished successfully."

```
## git-cliffï¼ˆgenerate changelog filesï¼‰

```bash
# doc
https://git-cliff.org/docs/

# Edit the default configuration (cliff.toml) as you like. Check out the examples for different templates.
git cliff --init

# Generate a changelog
git cliff -o CHANGELOG.md
```

## git message
**commit messageç±»å‹**
* ğŸ› || **fix**: ä¿®å¤äº†æŸä¸ª bug
* âœ¨ || **feat**: å¢åŠ äº†æŸä¸ªåŠŸèƒ½
* ğŸ›  || **build**: ä¸€äº›å½±å“æ„å»ºç³»ç»Ÿçš„æ›´æ–°
* ğŸ”€ || **change**: ä¸€äº›ä¸æ›´æ”¹æ ¸å¿ƒä»£ç çš„æ›´æ–°
* ğŸ’ || **style**: ä»£ç æ ¼å¼åŒ–ã€æ·»åŠ ç©ºæ ¼ç­‰ä»£ç æ ¼å¼å˜æ›´
* ğŸš€ || **perf**: æ”¹è¿›æ€§èƒ½çš„å˜åŒ–
* âš™ï¸ || **ci**: å˜æ›´äº†ä¸€äº› CI é…ç½®
* ğŸ“š || **docs**: å¯¹æ–‡æ¡£åšå‡ºäº†ä¸€äº›ä¿®æ”¹
* ğŸš¨ || **test**: æ–°å¢æˆ–ä¿®æ”¹æµ‹è¯•æ–‡ä»¶
* ğŸ“¦ || **refactor**: é‡æ„äº†ä»£ç ï¼ˆæ²¡æœ‰æ–°å¢/ä¿®å¤ï¼‰
* â™»ï¸ || **chore**: ä¸ä¿®æ”¹ä»£ç æ–‡ä»¶çš„å…¶ä»–ä¿®æ”¹
* ğŸ—‘ || **revert**: æ¢å¤ä¸Šæ¬¡çš„æäº¤
